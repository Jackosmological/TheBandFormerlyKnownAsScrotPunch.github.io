<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CRT TV</title>
<link rel="stylesheet" href="styles.css"/>
</head>

<body>

<div class="tv" id="tv">

  <img class="tv-screen" src="screen.png" alt="">

  <div class="tv-static"></div>

  <video class="tv-video" id="video" loop playsinline preload="metadata">
    <source src="band.mp4" type="video/mp4">
  </video>

  <button class="play-btn" id="playBtn" aria-label="Play/Pause"></button>

  <img class="tv-frame" src="tv.png" alt="">

  <!-- NEW: Red video select buttons (topmost) -->
  <button class="vid-btn" id="v1" data-src="clip1.mp4" aria-label="Play clip 1">1</button>
  <button class="vid-btn" id="v2" data-src="clip2.mp4" aria-label="Play clip 2">2</button>
  <button class="vid-btn" id="v3" data-src="clip3.mp4" aria-label="Play clip 3">3</button>
  <button class="vid-btn" id="v4" data-src="clip4.mp4" aria-label="Play clip 4">4</button>
  <button class="vid-btn" id="v5" data-src="clip5.mp4" aria-label="Play clip 5">5</button>

  <button class="vid-btn" id="vDefault" data-src="band.mp4" aria-label="Play default video">DEFAULT</button>

</div>

<audio id="staticAudio" loop preload="auto">
  <source src="static.mp3" type="audio/mpeg">
</audio>

<script>
const tv = document.getElementById("tv");
const video = document.getElementById("video");
const videoSource = video.querySelector("source");
const btn = document.getElementById("playBtn");
const staticAudio = document.getElementById("staticAudio");

let videoMode = false;

/* Start static visuals immediately */
tv.classList.add("static-on");

/* Try to start static audio as soon as possible.
   NOTE: many browsers block autoplay audio until user interacts. */
function startStaticAudio(){
  staticAudio.volume = 0.6;
  staticAudio.play().catch(()=>{ /* autoplay may be blocked */ });
}
window.addEventListener("load", startStaticAudio);

/* Helper: switch the video src + play, while preserving your layering/tweaks */
async function playVideoSrc(src){
  // If weâ€™re not in video mode yet, do the same transition as your first click
  if(!videoMode){
    videoMode = true;
    tv.classList.remove("static-on");
    tv.classList.add("video-on");
    staticAudio.pause();
    staticAudio.currentTime = 0;
  }

  // Swap only if different
  const current = videoSource.getAttribute("src") || "";
  if(current !== src){
    video.pause();
    videoSource.setAttribute("src", src);
    video.load();
  }

  try{ await video.play(); }catch(e){}
}

/* Button: first click starts video (and stops static), later clicks pause/play video */
btn.onclick = async ()=>{
  if(!videoMode){
    await playVideoSrc(videoSource.getAttribute("src") || "band.mp4");
    return;
  }

  // toggle pause/play
  if(video.paused){
    try{ await video.play(); }catch(e){}
  }else{
    video.pause();
  }
};

/* NEW: red buttons switch clips */
document.querySelectorAll(".vid-btn").forEach(b => {
  b.addEventListener("click", async (e) => {
    // Ensure clicks go to these buttons, not the big play overlay logic
    e.stopPropagation();
    const src = b.dataset.src;
    if(src) await playVideoSrc(src);
  });
});
</script>

</body>
</html>
